# 📦 前端部署指南

## ✅ 当前状态

- ✅ 项目依赖已安装
- ✅ 前端已成功构建
- ✅ 构建产物位于：`/workspace/frontend/dist/`
- ✅ 部署工具已安装：ossutil, aliyun-cli
- ⏳ 等待部署到阿里云 OSS

---

## 🚀 三种部署方案

### 方案一：阿里云控制台手动部署（推荐 - 最简单）⭐

**所需时间：5-10 分钟**

#### 步骤 1：创建 OSS Bucket

1. 访问阿里云 OSS 控制台：https://oss.console.aliyun.com/
2. 点击 **"创建 Bucket"**
3. 配置如下：
   - **Bucket 名称**：`photo-share-hub`（或任意唯一名称）
   - **区域**：华东1（杭州）`cn-hangzhou`
   - **读写权限**：**公共读**
   - **存储类型**：标准存储
   - 其他选项保持默认

#### 步骤 2：配置静态网站托管

1. 进入刚创建的 Bucket
2. 点击左侧 **"基础设置"**
3. 找到 **"静态页面"** 选项
4. 点击 **"设置"**
5. 配置：
   - **默认首页**：`index.html`
   - **默认 404 页**：`index.html`
6. 点击 **"保存"**

#### 步骤 3：上传构建文件

1. 点击 **"文件管理"**
2. 点击 **"上传文件"** 或 **"上传文件夹"**
3. 选择 `/workspace/frontend/dist/` 目录下的所有文件：
   ```
   dist/
   ├── index.html
   ├── vite.svg
   └── assets/
       ├── index-BvFXG2hv.css
       └── index-Uo8U5Yii.js
   ```
4. 上传完成后，确认文件列表显示正确

#### 步骤 4：访问网站

访问地址：`http://你的bucket名.oss-cn-hangzhou.aliyuncs.com/index.html`

例如：`http://photo-share-hub.oss-cn-hangzhou.aliyuncs.com/index.html`

---

### 方案二：使用命令行部署

**前提条件**：需要阿里云 AccessKey ID 和 AccessKey Secret

#### 步骤 1：配置 ossutil

```bash
# 配置 ossutil
ossutil config

# 按提示输入：
# Endpoint: oss-cn-hangzhou.aliyuncs.com
# AccessKeyID: 你的 AccessKey ID
# AccessKeySecret: 你的 AccessKey Secret
```

#### 步骤 2：创建 Bucket（可选，如果已创建则跳过）

```bash
# 设置 Bucket 名称
export BUCKET_NAME="photo-share-hub"

# 使用 aliyun CLI 创建 Bucket
aliyun oss mb oss://${BUCKET_NAME} --acl public-read --region cn-hangzhou
```

或者使用 ossutil：

```bash
ossutil mb oss://photo-share-hub --acl public-read --region cn-hangzhou
```

#### 步骤 3：上传文件

```bash
cd /workspace/frontend

# 上传所有文件到 OSS
ossutil cp -r -f dist/ oss://photo-share-hub/

# 设置文件类型
ossutil set-meta oss://photo-share-hub/ Content-Type:text/html --include "*.html" -r -f
ossutil set-meta oss://photo-share-hub/ Content-Type:text/css --include "*.css" -r -f
ossutil set-meta oss://photo-share-hub/ Content-Type:application/javascript --include "*.js" -r -f
ossutil set-meta oss://photo-share-hub/ Content-Type:image/svg+xml --include "*.svg" -r -f

# 设置缓存策略
ossutil set-meta oss://photo-share-hub/ Cache-Control:no-cache --include "*.html" -r -f
ossutil set-meta oss://photo-share-hub/ Cache-Control:max-age=31536000 --include "*.js" -r -f
ossutil set-meta oss://photo-share-hub/ Cache-Control:max-age=31536000 --include "*.css" -r -f
```

#### 步骤 4：访问网站

访问：`http://photo-share-hub.oss-cn-hangzhou.aliyuncs.com/index.html`

---

### 方案三：使用一键部署脚本

**前提条件**：已在 Cursor Dashboard 配置环境变量

#### 配置环境变量

在 Cursor Dashboard (Cloud Agents > Secrets) 中添加：

```
ALIYUN_AK = 你的 AccessKey ID
ALIYUN_SK = 你的 AccessKey Secret
```

#### 运行脚本

```bash
cd /workspace
./one-click-deploy.sh
```

脚本会自动完成：
1. 配置 ossutil
2. 检查/创建 Bucket
3. 构建项目（如需要）
4. 上传文件
5. 设置文件类型和缓存策略

---

## 🎨 配置 CDN 加速（可选但推荐）

### 为什么要配置 CDN？

- ⚡ **提升访问速度**：全球 CDN 节点加速
- 💰 **降低流量成本**：CDN 流量比 OSS 流量便宜约 60%
- 🌍 **全球加速**：海外用户访问更快
- 🔒 **HTTPS 支持**：更安全的访问

### 配置步骤

1. **登录 CDN 控制台**：https://cdn.console.aliyun.com/

2. **添加加速域名**：
   - 加速域名：`photos.yourdomain.com`（需要你自己的域名）
   - 业务类型：全站加速或图片小文件
   - 源站类型：OSS 域名
   - 源站地址：选择你的 Bucket

3. **配置 HTTPS**（推荐）：
   - 上传 SSL 证书或使用免费证书
   - 开启强制 HTTPS 跳转

4. **配置缓存规则**：
   ```
   *.html     -> 不缓存（0 秒）
   *.js       -> 缓存 1 年（31536000 秒）
   *.css      -> 缓存 1 年（31536000 秒）
   *.png      -> 缓存 1 年（31536000 秒）
   *.jpg      -> 缓存 1 年（31536000 秒）
   *.svg      -> 缓存 1 年（31536000 秒）
   ```

5. **配置 CNAME**：
   - 在域名服务商处添加 CNAME 记录
   - 记录值为 CDN 分配的域名

---

## 📊 构建信息

```
构建时间：2026-02-12
构建产物大小：1.1 MB
构建工具：Vite 7.3.1

文件列表：
- index.html (455 bytes)
- vite.svg (1.5 KB)
- assets/index-BvFXG2hv.css (8.46 KB)
- assets/index-Uo8U5Yii.js (1,027.55 KB)
```

---

## ❓ 常见问题

### Q1：如何获取 AccessKey？

1. 登录阿里云控制台：https://ram.console.aliyun.com/
2. 点击右上角头像 > AccessKey 管理
3. 创建 AccessKey，会得到 AccessKey ID 和 AccessKey Secret
4. **重要**：妥善保管 Secret，泄露后立即删除重建

### Q2：部署后访问显示 404？

检查：
1. Bucket 是否设置为"公共读"
2. 静态网站托管是否已开启
3. 默认首页是否设置为 `index.html`
4. 文件是否上传到 Bucket 根目录

### Q3：如何更新网站？

方法一（推荐）：
```bash
cd /workspace/frontend
npm run build
ossutil cp -r -f dist/ oss://你的bucket名/
```

方法二：在 OSS 控制台手动上传新文件覆盖旧文件

### Q4：预估成本是多少？

基于中小型使用场景（10GB 存储，100GB 月流量）：

| 服务 | 不使用 CDN | 使用 CDN |
|------|-----------|---------|
| OSS 存储 | ¥2/月 | ¥2/月 |
| OSS 流量 | ¥50/月 | ¥5/月 |
| CDN 流量 | - | ¥10/月 |
| **总计** | **¥52/月** | **¥17/月** |

💡 使用 CDN 可节省约 67% 的成本！

---

## 🎯 推荐流程

1. **首次部署**：使用方案一（控制台手动部署）
2. **测试验证**：访问 OSS 直连地址确认部署成功
3. **配置 CDN**：提升速度和降低成本
4. **绑定域名**：使用自己的域名（需备案）
5. **后续更新**：使用方案二（命令行）或方案三（脚本）

---

## 📚 相关文档

- 阿里云 OSS 文档：https://help.aliyun.com/product/31815.html
- 阿里云 CDN 文档：https://help.aliyun.com/product/27099.html
- 项目 README：`/workspace/frontend/README.md`
- 完整部署文档：`/workspace/QUICK_DEPLOY_GUIDE.md`

---

## 🆘 需要帮助？

如果遇到问题：
1. 检查阿里云账号是否已实名认证
2. 检查 OSS 服务是否已开通
3. 查看浏览器控制台错误信息
4. 查看 OSS 日志分析问题

---

**祝部署顺利！🚀**
